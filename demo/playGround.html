<!DOCTYPE html>
<html>
 
<head>
  <meta charset="utf-8" />
  <script src='http://d3js.org/d3.v4.js'></script>
  <script src="../build/cohortPanel.js"></script>
  <title></title>
</head>
 
<body>
  <div id='root'></div>
  <div id='root2'></div>
  <script>
  	const width = 800;
  	const height =400;
  	const drawCircle = (radius) => 'M '+(0-radius)+' '+0+' a '+radius+' '+radius+', 0, 1, 0, '+(radius*2)+' '+0+' '+'a '+radius+' '+radius+', 0, 1, 0, '+(-radius*2)+' '+0;
  	
  	d3.json('dataset_cohort_pairwise.txt',function(data){
  	   let dataSet = data.filter((d)=>d.logPval!==null);
       xMax = d3.max(dataSet.map((d)=>d.mean_ratio));
       xMin = d3.min(dataSet.map((d)=>d.mean_ratio));
       yMax = d3.max(dataSet.map((d)=>d.logPval));
       yMin = d3.min(dataSet.map((d)=>d.logPval));
       xFn = d3.scaleLinear().range([0,width]).domain([xMin,xMax]).nice();
       yFn = d3.scaleLinear().range([height,0]).domain([yMin,yMax]).nice();
       color = d3.scaleSequential().domain([yMin*xMin,yMax*xMax]).interpolator(d3.interpolateRainbow);
       
       

       nodes = dataSet.map((t,i)=>{
       	let item = {};
       	item.location={x:xFn(t.mean_ratio),y:yFn(t.logPval)};
       	item.shape={d:drawCircle(5),fill:color(t.mean_ratio*t.logPval)}
       	return item
       })
       cohortPanel.bindData(nodes)(d3.select('#root').node()); 
     
       

  	})
  </script>
  
</body>
 
</html>